<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">  
    <title>教师页面</title>

    <script src="__PUBLIC__/js/jquery-1.11.2.min.js"></script>      <!-- jQuery -->
    <script src="__PUBLIC__/js/jquery-migrate-1.2.1.min.js"></script> <!--  jQuery Migrate Plugin -->
    <script src="__PUBLIC__/js/jquery.uploadify.min.js" ></script>
    
    <script src="__PUBLIC__/js/bootstrap.min.js"></script>
    <script src="__PUBLIC__/js/templatemo-script.js"></script>   
    
      <!-- Templatemo Script -->
    <meta name="description" content="">
    <meta name="author" content="templatemo">
    <link href="__PUBLIC__/css/font-awesome.min.css" rel="stylesheet">
    <link href="__PUBLIC__/css/bootstrap.min.css" rel="stylesheet">
    <link href="__PUBLIC__/css/templatemo-style.css" rel="stylesheet">
    <link href="__PUBLIC__/css/uploadify.css" rel="stylesheet">
  </head>
  <body>  
    <!-- Left column -->
    <div class="templatemo-flex-row">
      <div class="templatemo-sidebar">
         <header class="templatemo-site-header">
          <div align="center"><img src="__PUBLIC__/images/person.jpg"  class="img-circle" height="50" width="50">
          <h2>教师用户</h2>
          </div>
        </header>
          
        <div class="profile-name" align="center">
        <span>{:session('teacher')['TeaName']}</span>
        <br>
        </div>

        <div class="profile-name" align="center">
        <span>{:session('teacher')['TeaID']}</span>
        <br>
        </div>
        

        <div class="mobile-menu-icon">
            <i class="fa fa-bars"></i>
        </div>
        <nav class="templatemo-left-nav">          
          <ul>
            <li><a href="__URL__/" class="active"><i class="fa fa-home fa-fw"></i>课程管理</a></li>
            <li><a href="__URL__/homework_index"><i class="fa fa-bar-chart fa-fw"></i>作业管理</a></li>
            <li><a href="__URL__/group"><i class="fa fa-bar-chart fa-fw"></i>团队管理</a></li>
            <li><a href="{:U(GROUP_NAME.'/Chat/chat',array('courseID' => session('teacher_selected_course')['CourseID'] ))}"><i class="fa fa-bar-chart fa-fw"></i>在线聊天</a></li>
            <li><a href="__URL__/personal_info"><i class="fa fa-bar-chart fa-fw"></i>个人信息</a></li>
            <li><a href="{:U(GROUP_NAME.'/LoginAndRegister/Logout')}"><i class="fa fa-bar-chart fa-fw"></i>登陆注销</a></li>
          </ul>  
        </nav>
      </div>
      <div class="templatemo-content col-1 light-gray-bg">
       
          <div class="row">
           
          
        </div>
        <div class="templatemo-content-container">
          <div class="templatemo-flex-row flex-content-row">
            <div class="templatemo-content-widget white-bg col-2">
              <!--<i class="fa fa-times"></i>-->
              <div class="file-navigation in-mid-page">
                <h2>课程资源分类</h2>
                <br />
                <div>
                <select id="all" name="category" class="form" onchange="changeCate();">
                  <option value="0">全部文件</option>
                  <option value="1">课件</option>
                  <option value="2">文档</option>
                  <option value="3">视频</option>
                </select>
                </div>
                  </div>
                 <!--   <button data-toggle="modal" data-target="#myModal" class="templatemo-edit-btn">下载文件</button>
                   <button data-toggle="modal" data-target="#deleteModal" class="templatemo-edit-btn">删除文件</button> -->
              <br />
              <div class="panel panel-default table-responsive">
              <form>
              <div class="right">
               <span style="display:inline-block;">
                      <input type="submit" formaction="__URL__/download" id="download" formmethod="get"class="templatemo-edit-btn" value="下载" >
                </span>
                <span style="display:inline-block;">
                      <input type="submit" id="delete" formaction="__URL__/delete" class="templatemo-edit-btn" formmethod="post" value="删除" >
                </span>
                </div>
              <table class="table table-striped table-bordered templatemo-user-table" >
              <thead>
                <tr>
                  <td></td>
                  <td>资源名称</td>
                  <td>上传时间</td>
                  <td>文件大小</td>
                </tr>
                </thead>
                <tbody id="appendant">
                  <foreach name='resourceList' item="r_t">
                  <tr>
                   <td>
                   <input type="checkbox" class="del" name="id_array[]" value="{$r_t['ResID']}"></td>
                   <td class="name">{$r_t['ResOriginName']}</td>
                   <td class="time">{$r_t['ReleaseTime']}</td>
                   <td class="size">{$r_t['FileSize']/1000}KB</td>
                  </tr>
                  </foreach>
                </tbody>
              </table>
              </form>
              </div>
              </div>    
              <div class="templatemo-content-widget-s white-bg col-6">
            <h2>上传文件</h2>
            <br />
            <!--<form accept-charset="utf-8" enctype="multipart/form-data" method="post" class="btn-group-form" action="">
            <input class="file-select" type="file" name="file" id="file" multiple="multiple"> 
            <input class="btn btn-sm right" type="submit" name="submit" value="上传文件"></input>
            <input class="btn btn-sm right" type="submit" name="submit" value="发布文件"></input>
            </form>-->
            <form accept-charset="utf-8" enctype="multipart/form-data" method="post" class="btn-group-form" action="__URL__/upload">
                
                <input id="file-select" name="file[]" type="file" multiple="true">
                <br />
                <select name="category" class="form">
                  <option value="课件">课件</option>
                  <option value="文档">文档</option>
                  <option value="视频">视频</option>
                </select>
                <input class="templatemo-edit-btn right" type="submit" name="submit" value="上传文件"></input>
            </form>
              <!-- <script type="text/javascript">
                $(function() {
                  $('#file-select').uploadify({
                    'swf'      : '__PUBLIC__/uploadify.swf',
                    'uploader' : '__PUBLIC__/uploadify.php',
                    'method'    : 'post',
                    'removeTimeout':1000
                  });
                });
              </script> -->
            </div>
          </div>
      </div>
    </div>
            </div>

   

<div class="modal fade" id="Assignment" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">发布作业</h4>
      </div>

      <form action="__URL__/addHomework" method="post">
        <div class="modal-body">
          <div class="form-group">
            <input type="text" required="required" class="form-control" name="homework_name" placeholder="作业标题"/>
            开始时间:<input required="required"  type="date" class="form-control" name="start_time"/>
            结束时间:<input required="required"  type="date" class="form-control" name="end_time"/>
            <input type="checkbox" name="isGroup" id="isGroup"/>是否是团队项目
            <textarea required="required"  class="form-control" name="require" placeholder="作业要求" rows="6"></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <input type="submit" class="btn btn-info" value="发布" />
          <input type="button" class="btn btn-default" data-dismiss="modal" value="关闭" />
        </div>
      </form>

    </div>
    </div>
    </div>

 <script>
     var p1=0;
     var category = $('select[name = "category"]');
     function changeCate(){
        
        var resUrl = '__URL__/ajaxCourse/course_id/}';
        $.ajax({
            type:'POST',
            url:resUrl,
            data:{
              category:category.val(),
            },
            success:function(data){
              load(data);
              //      
            },
            dataType:"json"
        });

    }
    function load(data){
        $("#appendant").empty();
        if($("#all").val()==0)
        {
           $("#appendant").append("<foreach name='resourceList' item='r_t'><tr><td><input type='checkbox' class='del' name='id_array[]' value='{$r_t['ResID']}'></td><td class='name'>{$r_t['ResOriginName']}</td><td class='time'>{$r_t['ReleaseTime']}</td><td class='size'>{$r_t['FileSize']/1000}KB</td></tr></foreach>");
        }
        else{
      for(var i=0,l=data.length;i<l;i++){
          p1=0;
      for(var key in data[i]){  
      if(key=="ResOriginName") {p1=i;}
     }

       $("#appendant").append("<tr><td><input type='checkbox' class='del' name='id_array[]' value='"+data[p1]["ResID"]+"'></td><td>"+data[p1]["ResOriginName"]+"</td><td>"+data[p1]["ReleaseTime"]+"</td><td>"+data[p1]["FileSize"]/1000+"KB</td></tr>");
    }
  }
}
     $('#download').click(function(){
         var p=$(".del").is(':checked');
         if(p==false) alert('请至少选择一个下载或删除项目！');
     })
     $('#delete').click(function(){
         var p=$(".del").is(':checked');
         if(p==false) alert('请至少选择一个下载或删除项目！');
     })
  </script>
  </body>